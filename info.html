<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ASSIGNME - FAQ + Question en bas</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#000;
      --text:#e8f4ff;
      --muted:#a9bbd6;
      --neon:#5ca0ff;
      --btn:#5f95ff;
      --btnHover:#7ecbff;
      --faq:#cfe0ff;
      --faqHover:#dff0ff;
      --faqActive:#6c8cff;
    }

    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      background:var(--bg);
      color:var(--text);
      overflow-x:hidden;
    }

    header {
      width: 100%;
      padding: 20px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: fixed;
      top: 0;
      left: 0;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(15px);
      z-index: 1000;
      border-bottom: 2px solid rgba(100, 149, 237, 0.3);
      box-shadow: 0 4px 20px rgba(100, 149, 237, 0.1);
      height: 80px;
    }

    .hero{
      min-height: 100vh;
      padding-top: 80px; /* Hauteur du header */
      position: relative;
      background: #000 url('design.png') no-repeat center center / contain;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1;
    }

    /* Vignette panel avec positionnement amélioré */
    .panel{
      position: absolute; 
      right: 220px; 
      top: 50%; 
      transform: translateY(-50%);
      width: 260px; 
      max-height: calc(100vh - 120px); /* Évite le débordement sur header/footer */
      display: flex; 
      flex-direction: column;
      border-radius: 14px; 
      background: #000;
      border: 1.5px solid rgba(92,160,255,.9);
      box-shadow: 0 0 14px rgba(92,160,255,.75), 0 0 36px rgba(92,160,255,.28);
      overflow: hidden; 
      isolation: isolate;
      z-index: 1000;
    }
    
    .panel::before{
      content:''; position:absolute; inset:-7px; border-radius:inherit; pointer-events:none;
      border:2px solid rgba(92,160,255,.85);
      filter:blur(7px); animation:neonPulse 3s ease-in-out infinite;
      z-index:-1;
    }
    
    @keyframes neonPulse{
      0%,100%{opacity:.85; filter:blur(6px)}
      50%{opacity:1; filter:blur(9px)}
    }

    /* Scrollable content */
    .scroll{
      flex:1 1 auto; overflow:auto;
      padding:10px;
    }

    /* Answer box */
    .answer-box{
      margin-bottom:10px; padding:10px;
      border:1px solid rgba(92,160,255,.35); border-radius:10px;
      background:rgba(255,255,255,.04); font-size:.8rem; line-height:1.5;
      display:none;
    }
    .answer-box strong{color:#fff}

    /* FAQ list */
    .faq-list{list-style:none;display:flex;flex-direction:column;gap:8px}
    .faq-item{border-radius:10px;overflow:hidden}
    .faq-btn{
      width:100%; display:flex; align-items:center; justify-content:space-between;
      gap:10px; cursor:pointer; border:none; outline:none;
      padding:10px 12px; color:#001; font-weight:800; font-size:.82rem;
      background:var(--faq); border-radius:10px;
      box-shadow:0 2px 9px rgba(92,160,255,.22);
      text-align:left; transition:.18s ease;
    }
    .faq-btn:hover{background:var(--faqHover)}
    .faq-btn[aria-expanded="true"]{background:var(--faqActive); color:#001}
    .chev{width:10px;height:10px;flex:0 0 auto;border-right:2px solid currentColor;border-bottom:2px solid currentColor;transform:rotate(45deg); transition:.18s ease}
    .faq-btn[aria-expanded="true"] .chev{transform:rotate(-135deg)}
    .answer{max-height:0; overflow:hidden; transition:max-height .22s ease}
    .answer-inner{padding:10px 12px 12px; font-size:.78rem; line-height:1.55; background:rgba(255,255,255,.07); border-radius:10px; margin-top:4px}

    /* Question input */
    .input-wrap{
      margin-top:12px;
      display:flex; gap:6px;
      border-top:1px dashed rgba(92,160,255,.35);
      padding-top:8px;
    }
    .in{
      flex:1; min-width:0; padding:10px 12px; border-radius:10px;
      border:1px solid rgba(92,160,255,.5); background:#0b0f17; color:var(--text); font-size:.82rem;
      outline:none; transition:border-color .15s ease, box-shadow .15s ease;
    }
    .in:focus{ border-color:var(--neon); box-shadow:0 0 0 3px rgba(92,160,255,.25) }
    .send{
      padding:10px 12px; border:none; border-radius:10px;
      background:var(--faq); color:#001; font-weight:800; font-size:.8rem;
      cursor:pointer; box-shadow:0 2px 10px rgba(92,160,255,.25);
    }
    .send:hover{ background:var(--faqHover) }
    .send:active{ transform:translateY(1px) }

    .logo-header {
      font-size: 20px;
      font-weight: bold;
      display: flex;
      align-items: center;
      color: white;
      text-transform: uppercase;
      letter-spacing: 1px;
      text-decoration: none;
    }
    .contact-btn {
      padding: 12px 24px;
      background: linear-gradient(45deg, #6495ed, #87ceeb);
      color: #0f0f23;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      font-weight: bold;
      text-decoration: none;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(100, 149, 237, 0.4);
      text-transform: uppercase;
      letter-spacing: 1px;
      display: inline-block;
    }
    .contact-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 25px rgba(100, 149, 237, 0.6);
      background: linear-gradient(45deg, #87ceeb, #b0e0e6);
    }
    .logo-header:visited{ color:white; }
    .logo-header:hover{ color:white; text-decoration:none; }

    .footer {
      background: #000000;
      padding: 40px 20px;
      text-align: center;
      border-top: 1px solid rgba(100, 149, 237, 0.2);
      position: relative;
    }
    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      color: #87ceeb;
    }

    /* Responsive design amélioré */
    @media (max-width: 1200px){
      .panel{right:140px; width:260px;}
    }

    @media (max-width: 900px){
      .hero{
        padding-top: 80px;
        background-position: center 100px;
        background-size: 70% auto;
        min-height: calc(100vh - 80px);
        padding-bottom: 100px;
      }
      
      .panel{
        position: fixed;
        right: 50%;
        left: auto;
        top: auto;
        bottom: 60px;
        transform: translateX(50%);
        width: min(90vw, 400px);
        max-height: 45vh;
        z-index: 999;
      }
      
      .footer {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        padding: 8px 10px;
        z-index: 1001;
        background: rgba(0, 0, 0, 0.98);
        backdrop-filter: blur(15px);
        border-top: 1px solid rgba(100, 149, 237, 0.2);
      }
      
      .footer-content {
        font-size: 10px;
        line-height: 1.2;
        color: #87ceeb;
      }
    }

    /* Spécial iPhone et petits écrans */
    @media (max-width: 768px) {
      header { 
        padding: 15px 20px; 
        height: 70px;
      }
      
      .hero {
        padding-top: 70px;
        background-position: center 120px;
        background-size: 80% auto;
        min-height: calc(100vh - 70px);
        padding-bottom: 100px;
      }
      
      .logo-header { 
        font-size: 16px; 
      }
      
      .logo-header img { 
        height: 40px !important; 
        margin-right: 8px !important; 
      }
      
      .contact-btn { 
        padding: 10px 16px; 
        font-size: 12px; 
      }
      
      .panel {
        bottom: 50px;
        width: min(92vw, 380px);
        max-height: 40vh;
      }
      
      .footer {
        padding: 6px 8px;
        z-index: 1001;
        background: rgba(0, 0, 0, 0.98);
      }
      
      .footer-content {
        font-size: 9px;
        line-height: 1.1;
      }
    }

    @media (max-width: 480px){
      .hero {
        padding-top: 70px;
        background-position: center 130px;
        background-size: 85% auto;
        padding-bottom: 100px;
      }
      
      .answer-inner{
        font-size:.72rem;
      }
      
      .panel {
        width: calc(100vw - 20px);
        max-height: 35vh;
        bottom: 45px;
      }
      
      .footer {
        padding: 5px 6px;
        z-index: 1001;
      }
      
      .footer-content {
        font-size: 8px;
        line-height: 1;
      }
    }

    /* Éviter le débordement sur très petits écrans */
    @media (max-height: 600px) {
      .panel {
        max-height: 35vh;
      }
      
      .hero {
        padding-top: 0;
        background-position: center 0;
      }
    }
    
    @media (max-height: 700px) and (max-width: 900px) {
      .hero {
        padding-top: 5px;
        background-position: center 5px;
      }
      
      .panel {
        max-height: 40vh;
      }
    }
  </style>
</head>
<body>
  <header>
    <a class="logo-header" href="index.html">
      <img alt="Assignme Logo" src="logo.png" style="height:50px; width:auto; margin-right:10px;">
      ASSIGNME
    </a>
    <a class="contact-btn" href="mailto:contact@assignme.fr">
      Nous contacter
    </a>
  </header>

  <main class="hero" role="main" aria-label="Hero">
    <aside class="panel" aria-label="FAQ et question libre">
      <div class="scroll">
        <!-- Answer area (shows GPT+dossier response) -->
        <div id="qa-answer" class="answer-box"></div>

        <!-- FAQ list -->
        <ul class="faq-list" role="list">
          <li class="faq-item">
            <button id="q1" class="faq-btn" aria-expanded="false" aria-controls="a1">
              <span>Qu'est-ce qu'ASSIGNME ?</span><span class="chev" aria-hidden="true"></span>
            </button>
            <div id="a1" class="answer" role="region" aria-labelledby="q1">
              <div class="answer-inner">
                ASSIGNME est une plateforme SaaS DeepTech qui automatise le matching candidats → opportunités via IA, en quelques minutes.
              </div>
            </div>
          </li>

          <li class="faq-item">
            <button id="q2" class="faq-btn" aria-expanded="false" aria-controls="a2">
              <span>Quel problème résolvez‑vous ?</span><span class="chev" aria-hidden="true"></span>
            </button>
            <div id="a2" class="answer" role="region" aria-labelledby="q2">
              <div class="answer-inner">
                Nous réduisons drastiquement délais et coûts de recrutement tout en simplifiant le parcours candidat.
              </div>
            </div>
          </li>

          <li class="faq-item">
            <button id="q3" class="faq-btn" aria-expanded="false" aria-controls="a3">
              <span>Qui peut utiliser ASSIGNME ?</span><span class="chev" aria-hidden="true"></span>
            </button>
            <div id="a3" class="answer" role="region" aria-labelledby="q3">
              <div class="answer-inner">
                Candidats, recruteurs privés (PME, hôpitaux, cabinets RH) et acteurs publics (ex. France Travail).
              </div>
            </div>
          </li>

          <li class="faq-item">
            <button id="q4" class="faq-btn" aria-expanded="false" aria-controls="a4">
              <span>Comment ça fonctionne ?</span><span class="chev" aria-hidden="true"></span>
            </button>
            <div id="a4" class="answer" role="region" aria-labelledby="q4">
              <div class="answer-inner">
                IA de compréhension sémantique (profils &amp; offres), détection des correspondances implicites et génération automatique de candidatures.
              </div>
            </div>
          </li>

          <li class="faq-item">
            <button id="q5" class="faq-btn" aria-expanded="false" aria-controls="a5">
              <span>En quoi êtes‑vous différents des job boards ?</span><span class="chev" aria-hidden="true"></span>
            </button>
            <div id="a5" class="answer" role="region" aria-labelledby="q5">
              <div class="answer-inner">
                Pas de recherche par mots‑clés : le matching est contextuel et proactif, l'IA pousse les opportunités pertinentes.
              </div>
            </div>
          </li>

          <li class="faq-item">
            <button id="q6" class="faq-btn" aria-expanded="false" aria-controls="a6">
              <span>Où en êtes‑vous aujourd'hui ?</span><span class="chev" aria-hidden="true"></span>
            </button>
            <div id="a6" class="answer" role="region" aria-labelledby="q6">
              <div class="answer-inner">
                MVP en cours, démonstrateur en ligne et programme pilotes sur 12&nbsp;mois.
              </div>
            </div>
          </li>

          <li class="faq-item">
            <button id="q7" class="faq-btn" aria-expanded="false" aria-controls="a7">
              <span>Quelle est votre ambition ?</span><span class="chev" aria-hidden="true"></span>
            </button>
            <div id="a7" class="answer" role="region" aria-labelledby="q7">
              <div class="answer-inner">
                Devenir le standard européen du matching emploi‑compétences basé IA, privé et public.
              </div>
            </div>
          </li>
        </ul>

        <!-- Question input placed directly below the FAQ list -->
        <div class="input-wrap">
          <input id="qa-input" class="in" type="text" placeholder="Pose ta question" aria-label="Votre question">
          <button id="qa-send" class="send" type="button">Envoyer</button>
        </div>
      </div>
    </aside>
  </main>

  <script>
    (function(){
      /* FAQ accordion */
      const btns=[...document.querySelectorAll('.faq-btn')];
      function closeAll(except){
        btns.forEach(b=>{
          if(b!==except){
            b.setAttribute('aria-expanded','false');
            const id=b.getAttribute('aria-controls');
            const el=document.getElementById(id);
            if(el) el.style.maxHeight='0px';
          }
        });
      }
      function toggle(btn){
        const open=btn.getAttribute('aria-expanded')==='true';
        const id=btn.getAttribute('aria-controls');
        const el=document.getElementById(id);
        if(!el) return;
        if(open){ btn.setAttribute('aria-expanded','false'); el.style.maxHeight='0px'; }
        else{ closeAll(btn); btn.setAttribute('aria-expanded','true'); el.style.maxHeight=el.scrollHeight+'px'; }
      }
      btns.forEach(btn=>{
        btn.addEventListener('click',()=>toggle(btn));
        btn.addEventListener('keydown',(e)=>{ if(e.key==='Enter'||e.key===' '){e.preventDefault();toggle(btn);} });
      });
      let t; window.addEventListener('resize',()=>{
        clearTimeout(t); t=setTimeout(()=>{
          btns.forEach(btn=>{
            if(btn.getAttribute('aria-expanded')==='true'){
              const id=btn.getAttribute('aria-controls');
              const el=document.getElementById(id);
              if(el) el.style.maxHeight=el.scrollHeight+'px';
            }
          });
        },120);
      });

      /* Bottom Q&A using GPT + dossier (backend at /.netlify/functions/ask) */
      const input = document.getElementById('qa-input');
      const send  = document.getElementById('qa-send');
      const box   = document.getElementById('qa-answer');
      const API_URL = '/.netlify/functions/ask';

      function ensureAnswerBox(){
        if(!box) return;
        box.style.display = 'block';
        if(!box.parentNode) {
          // safety: should exist
        }
      }
      function showAnswer(text){
        if(!box) return;
        box.style.display = 'block';
        box.innerHTML = `<div style="color: #e8f4ff; line-height: 1.6;">${text}</div>`;
        box.scrollIntoView({ behavior:'smooth', block:'nearest' });
      }

      async function ask(question){
        showAnswer('<div style="color: #87ceeb; font-style: italic;">Analyse de la question en cours...</div>');
        try{
          const res = await fetch(API_URL, {
            method:'POST',
            headers:{ 'Content-Type':'application/json' },
            body: JSON.stringify({ question })
          });
          if(!res.ok){
            const errorData = await res.json().catch(() => ({}));
            if (res.status === 429) {
              throw new Error('Limite de requêtes atteinte. Veuillez réessayer dans quelques minutes.');
            }
            throw new Error(errorData.error || `Erreur ${res.status}`);
          }
          const data = await res.json();
          const answer = (data.answer || '').trim() || "Cette information n'est pas disponible dans le dossier ASSIGNME.";
          showAnswer(answer);
        }catch(err){
          showAnswer(`<div style="color: #ff6b6b;">Erreur : ${err.message}</div>`);
        }
      }

      function submit(){
        const q = (input.value || '').trim();
        if(!q) return;
        ask(q);
        input.value='';
        input.focus();
      }
      send.addEventListener('click', submit);
      input.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ e.preventDefault(); submit(); } });
    })();
  </script>

  <footer class="footer">
    <div class="footer-content">
      <p>&copy; 2025 ASSIGNME. Tous droits réservés. | Une innovation DeepTech française</p>
    </div>
  </footer>
</body>
</html>
